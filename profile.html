<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ« - GIFT</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ</text></svg>">
</head>
<body>
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="header">
        <div class="header-content">
            <a href="index.html" class="logo">GIFT</a>
            <div style="width: 60px;"></div> <!-- ä¸­å¤®æƒãˆã®ãŸã‚ã®ã‚¹ãƒšãƒ¼ã‚µãƒ¼ -->
        </div>
    </header>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main class="main-content">
        <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="hero">
            <div class="hero-content">
                <h1>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</h1>
                <p>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã®ç¢ºèªãƒ»ç·¨é›†ãŒã§ãã¾ã™</p>
            </div>
        </section>

        <!-- ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ± -->
        <section class="card">
            <h2>åŸºæœ¬æƒ…å ±</h2>
            <form id="profile-form">
                <div class="grid grid-2">
                    <div class="form-group">
                        <label for="first-name">å§“ *</label>
                        <input type="text" id="first-name" name="first-name" class="form-control" value="ç”°ä¸­" required>
                    </div>
                    <div class="form-group">
                        <label for="last-name">å *</label>
                        <input type="text" id="last-name" name="last-name" class="form-control" value="å¤ªéƒ" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ *</label>
                    <input type="email" id="email" name="email" class="form-control" value="tanaka@example.com" required>
                </div>
                
                <div class="form-group">
                    <label for="phone">é›»è©±ç•ªå·</label>
                    <input type="tel" id="phone" name="phone" class="form-control" value="090-1234-5678" placeholder="ä¾‹: 090-1234-5678">
                </div>
                
                <div class="form-group">
                    <label for="birth-date">ç”Ÿå¹´æœˆæ—¥</label>
                    <input type="date" id="birth-date" name="birth-date" class="form-control" value="1990-01-01">
                </div>
                
                <div class="form-group">
                    <label for="gender">æ€§åˆ¥</label>
                    <select id="gender" name="gender" class="form-control">
                        <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                        <option value="male" selected>ç”·æ€§</option>
                        <option value="female">å¥³æ€§</option>
                        <option value="other">ãã®ä»–</option>
                        <option value="prefer-not-to-say">å›ç­”ã—ãªã„</option>
                    </select>
                </div>
                
                <div class="text-center" style="margin-top: 2rem;">
                    <button type="submit" class="btn">åŸºæœ¬æƒ…å ±ã‚’æ›´æ–°</button>
                </div>
            </form>
        </section>

        <!-- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ -->
        <section class="card">
            <h2>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´</h2>
            <form id="password-form">
                <div class="form-group">
                    <label for="current-password">ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ *</label>
                    <input type="password" id="current-password" name="current-password" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="new-password">æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ *</label>
                    <input type="password" id="new-password" name="new-password" class="form-control" required>
                    <small style="color: var(--color-text-secondary);">8æ–‡å­—ä»¥ä¸Šã§ã€è‹±æ•°å­—ã‚’å«ã‚ã¦ãã ã•ã„</small>
                </div>
                
                <div class="form-group">
                    <label for="confirm-password">æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆç¢ºèªï¼‰ *</label>
                    <input type="password" id="confirm-password" name="confirm-password" class="form-control" required>
                </div>
                
                <div class="text-center" style="margin-top: 2rem;">
                    <button type="submit" class="btn btn-secondary">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´</button>
                </div>
            </form>
        </section>

        <!-- é€šçŸ¥è¨­å®š -->
        <section class="card">
            <h2>é€šçŸ¥è¨­å®š</h2>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="notify-email" name="notify-email" checked>
                    <label for="notify-email">ãƒ¡ãƒ¼ãƒ«é€šçŸ¥</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="notify-push" name="notify-push" checked>
                    <label for="notify-push">ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="notify-promotion" name="notify-promotion">
                    <label for="notify-promotion">ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³æƒ…å ±</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="notify-newsletter" name="notify-newsletter">
                    <label for="notify-newsletter">ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ¬ã‚¿ãƒ¼</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="notify-gift-updates" name="notify-gift-updates" checked>
                    <label for="notify-gift-updates">ã‚®ãƒ•ãƒˆçŠ¶æ³ã®æ›´æ–°</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="notify-reminders" name="notify-reminders" checked>
                    <label for="notify-reminders">å¥åº·ãƒã‚§ãƒƒã‚¯ã®ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼</label>
                </div>
            </div>
            <div class="text-center" style="margin-top: 1.5rem;">
                <button class="btn btn-secondary" onclick="saveNotificationSettings()">é€šçŸ¥è¨­å®šã‚’ä¿å­˜</button>
            </div>
        </section>

        <!-- ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼è¨­å®š -->
        <section class="card">
            <h2>ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼è¨­å®š</h2>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="profile-public" name="profile-public">
                    <label for="profile-public">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’å…¬é–‹ã™ã‚‹</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="gift-history-public" name="gift-history-public">
                    <label for="gift-history-public">ã‚®ãƒ•ãƒˆå±¥æ­´ã‚’å…¬é–‹ã™ã‚‹</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="allow-friend-requests" name="allow-friend-requests" checked>
                    <label for="allow-friend-requests">å‹é”ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¨±å¯ã™ã‚‹</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="show-online-status" name="show-online-status" checked>
                    <label for="show-online-status">ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¡¨ç¤ºã™ã‚‹</label>
                </div>
            </div>
            <div class="text-center" style="margin-top: 1.5rem;">
                <button class="btn btn-secondary" onclick="savePrivacySettings()">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼è¨­å®šã‚’ä¿å­˜</button>
            </div>
        </section>

        <!-- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç† -->
        <section class="card">
            <h2>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†</h2>
            <div class="grid grid-2">
                <div class="choice-card" onclick="showDeleteAccountModal()">
                    <div class="icon">ğŸ—‘ï¸</div>
                    <h3>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤</h3>
                    <p>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å®Œå…¨ã«å‰Šé™¤ã—ã¾ã™ï¼ˆå–ã‚Šæ¶ˆã—ä¸å¯ï¼‰</p>
                </div>
                <div class="choice-card" onclick="showDataExportModal()">
                    <div class="icon">ğŸ“¤</div>
                    <h3>ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</h3>
                    <p>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’CSVãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</p>
                </div>
            </div>
        </section>

        <!-- é€£æºã‚¢ã‚«ã‚¦ãƒ³ãƒˆ -->
        <section class="card">
            <h2>é€£æºã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</h2>
            <div class="grid grid-2">
                <div style="background: var(--color-background-light); padding: 1.5rem; border-radius: var(--border-radius-md);">
                    <h3>Google</h3>
                    <p>é€£æºæ¸ˆã¿</p>
                    <button class="btn btn-secondary" onclick="disconnectGoogle()">é€£æºè§£é™¤</button>
                </div>
                <div style="background: var(--color-background-light); padding: 1.5rem; border-radius: var(--border-radius-md);">
                    <h3>Apple</h3>
                    <p>æœªé€£æº</p>
                    <button class="btn" onclick="connectApple()">é€£æºã™ã‚‹</button>
                </div>
            </div>
        </section>
    </main>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
    <nav class="footer-nav">
        <div class="footer-nav-content">
            <a href="index.html" class="footer-nav-item">
                <div class="footer-nav-icon">ğŸ </div>
                <div class="footer-nav-text">ãƒ›ãƒ¼ãƒ </div>
            </a>
            <a href="send_gifts.html" class="footer-nav-item">
                <div class="footer-nav-icon">ğŸ</div>
                <div class="footer-nav-text">ã‚®ãƒ•ãƒˆ</div>
            </a>
            <a href="mypage.html" class="footer-nav-item active">
                <div class="footer-nav-icon">ğŸ‘¤</div>
                <div class="footer-nav-text">ãƒã‚¤ãƒšãƒ¼ã‚¸</div>
            </a>
            <a href="history_send.html" class="footer-nav-item">
                <div class="footer-nav-icon">ğŸ“‹</div>
                <div class="footer-nav-text">å±¥æ­´</div>
            </a>
        </div>
    </nav>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <footer class="footer">
        <p>&copy; 2024 GIFT. All rights reserved.</p>
    </footer>

    <!-- ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="delete-account-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤ã®ç¢ºèª</h3>
            <p>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å‰Šé™¤ã™ã‚‹ã¨ã€ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒå®Œå…¨ã«å‰Šé™¤ã•ã‚Œã€å¾©å…ƒã§ãã¾ã›ã‚“ã€‚</p>
            <p>æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ</p>
            <div class="modal-actions">
                <button class="btn btn-danger" onclick="deleteAccount()">å‰Šé™¤ã™ã‚‹</button>
                <button class="btn btn-secondary" onclick="closeModal('delete-account-modal')">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
            </div>
        </div>
    </div>

    <div id="data-export-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</h3>
            <p>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’CSVãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚</p>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="export-profile" checked>
                    <label for="export-profile">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="export-history" checked>
                    <label for="export-history">ã‚®ãƒ•ãƒˆå±¥æ­´</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="export-settings" checked>
                    <label for="export-settings">è¨­å®šæƒ…å ±</label>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn" onclick="exportData()">ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
                <button class="btn btn-secondary" onclick="closeModal('data-export-modal')">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
            </div>
        </div>
    </div>

    <script src="js/script.js"></script>
    <script>
        // ãƒšãƒ¼ã‚¸å›ºæœ‰ã®JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å‡¦ç†
            document.getElementById('profile-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                const profileData = {};
                
                for (let [key, value] of formData.entries()) {
                    profileData[key] = value;
                }
                
                // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã‚’ä¿å­˜ï¼ˆå®Ÿéš›ã®ã‚¢ãƒ—ãƒªã§ã¯ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ï¼‰
                localStorage.setItem('profileData', JSON.stringify(profileData));
                
                showSuccessMessage('ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸ');
            });
            
            // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å‡¦ç†
            document.getElementById('password-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const currentPassword = document.getElementById('current-password').value;
                const newPassword = document.getElementById('new-password').value;
                const confirmPassword = document.getElementById('confirm-password').value;
                
                // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¤œè¨¼
                if (newPassword.length < 8) {
                    showErrorMessage('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯8æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„');
                    return;
                }
                
                if (!/[a-zA-Z]/.test(newPassword) || !/[0-9]/.test(newPassword)) {
                    showErrorMessage('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯è‹±æ•°å­—ã‚’å«ã‚ã¦ãã ã•ã„');
                    return;
                }
                
                if (newPassword !== confirmPassword) {
                    showErrorMessage('æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“');
                    return;
                }
                
                // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´å‡¦ç†ï¼ˆå®Ÿéš›ã®ã‚¢ãƒ—ãƒªã§ã¯ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ï¼‰
                showSuccessMessage('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ã¾ã—ãŸ');
                
                // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ
                this.reset();
            });
            
            // ä¿å­˜ã•ã‚ŒãŸè¨­å®šã‚’èª­ã¿è¾¼ã¿
            loadSavedSettings();
        });

        // é€šçŸ¥è¨­å®šä¿å­˜
        function saveNotificationSettings() {
            const settings = {
                email: document.getElementById('notify-email').checked,
                push: document.getElementById('notify-push').checked,
                promotion: document.getElementById('notify-promotion').checked,
                newsletter: document.getElementById('notify-newsletter').checked,
                giftUpdates: document.getElementById('notify-gift-updates').checked,
                reminders: document.getElementById('notify-reminders').checked
            };
            
            localStorage.setItem('notificationSettings', JSON.stringify(settings));
            showSuccessMessage('é€šçŸ¥è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ');
        }

        // ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼è¨­å®šä¿å­˜
        function savePrivacySettings() {
            const settings = {
                profilePublic: document.getElementById('profile-public').checked,
                giftHistoryPublic: document.getElementById('gift-history-public').checked,
                allowFriendRequests: document.getElementById('allow-friend-requests').checked,
                showOnlineStatus: document.getElementById('show-online-status').checked
            };
            
            localStorage.setItem('privacySettings', JSON.stringify(settings));
            showSuccessMessage('ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ');
        }

        // ä¿å­˜ã•ã‚ŒãŸè¨­å®šã‚’èª­ã¿è¾¼ã¿
        function loadSavedSettings() {
            // é€šçŸ¥è¨­å®š
            const notificationSettings = localStorage.getItem('notificationSettings');
            if (notificationSettings) {
                const settings = JSON.parse(notificationSettings);
                document.getElementById('notify-email').checked = settings.email;
                document.getElementById('notify-push').checked = settings.push;
                document.getElementById('notify-promotion').checked = settings.promotion;
                document.getElementById('notify-newsletter').checked = settings.newsletter;
                document.getElementById('notify-gift-updates').checked = settings.giftUpdates;
                document.getElementById('notify-reminders').checked = settings.reminders;
            }
            
            // ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼è¨­å®š
            const privacySettings = localStorage.getItem('privacySettings');
            if (privacySettings) {
                const settings = JSON.parse(privacySettings);
                document.getElementById('profile-public').checked = settings.profilePublic;
                document.getElementById('gift-history-public').checked = settings.giftHistoryPublic;
                document.getElementById('allow-friend-requests').checked = settings.allowFriendRequests;
                document.getElementById('show-online-status').checked = settings.showOnlineStatus;
            }
        }

        // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º
        function showDeleteAccountModal() {
            document.getElementById('delete-account-modal').style.display = 'flex';
        }

        // ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º
        function showDataExportModal() {
            document.getElementById('data-export-modal').style.display = 'flex';
        }

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤
        function deleteAccount() {
            if (confirm('æœ¬å½“ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
                // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤å‡¦ç†ï¼ˆå®Ÿéš›ã®ã‚¢ãƒ—ãƒªã§ã¯ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ï¼‰
                showSuccessMessage('ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 2000);
            }
            closeModal('delete-account-modal');
        }

        // ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
        function exportData() {
            const includeProfile = document.getElementById('export-profile').checked;
            const includeHistory = document.getElementById('export-history').checked;
            const includeSettings = document.getElementById('export-settings').checked;
            
            // CSVãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ
            let csvContent = '';
            
            if (includeProfile) {
                const profileData = localStorage.getItem('profileData');
                if (profileData) {
                    csvContent += 'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±\n';
                    csvContent += 'é …ç›®,å€¤\n';
                    const profile = JSON.parse(profileData);
                    for (let [key, value] of Object.entries(profile)) {
                        csvContent += `${key},${value}\n`;
                    }
                    csvContent += '\n';
                }
            }
            
            if (includeHistory) {
                csvContent += 'ã‚®ãƒ•ãƒˆå±¥æ­´\n';
                csvContent += 'ID,ã‚¿ã‚¤ãƒ—,ã‚®ãƒ•ãƒˆå,ç›¸æ‰‹,é‡‘é¡,æ—¥ä»˜,ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹\n';
                // å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ï¼ˆå®Ÿéš›ã®ã‚¢ãƒ—ãƒªã§ã¯ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å–å¾—ï¼‰
                csvContent += '1,é€ä¿¡,å¥åº·è¨ºæ–­ãƒ‘ãƒƒã‚¯A,ç”°ä¸­èŠ±å­,15000,2024-01-15,å®Œäº†\n';
            }
            
            if (includeSettings) {
                csvContent += 'è¨­å®šæƒ…å ±\n';
                csvContent += 'é …ç›®,å€¤\n';
                const notificationSettings = localStorage.getItem('notificationSettings');
                const privacySettings = localStorage.getItem('privacySettings');
                
                if (notificationSettings) {
                    const settings = JSON.parse(notificationSettings);
                    for (let [key, value] of Object.entries(settings)) {
                        csvContent += `é€šçŸ¥_${key},${value}\n`;
                    }
                }
                
                if (privacySettings) {
                    const settings = JSON.parse(privacySettings);
                    for (let [key, value] of Object.entries(settings)) {
                        csvContent += `ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼_${key},${value}\n`;
                    }
                }
            }
            
            // CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `gift_data_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showSuccessMessage('ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ');
            closeModal('data-export-modal');
        }

        // é€£æºã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ©Ÿèƒ½
        function disconnectGoogle() {
            if (confirm('Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ã®é€£æºã‚’è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                showSuccessMessage('Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ã®é€£æºã‚’è§£é™¤ã—ã¾ã—ãŸ');
            }
        }

        function connectApple() {
            showSuccessMessage('Appleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ã®é€£æºã‚’é–‹å§‹ã—ã¾ã—ãŸ');
        }
    </script>
</body>
</html> 