<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å±¥æ­´ - GIFT</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="header">
        <div class="header-content">
            <a href="index.html" class="logo">ğŸ GIFT</a>
            <nav>
                <ul class="nav-menu">
                    <li><a href="about.html">GIFTã«ã¤ã„ã¦</a></li>
                    <li><a href="send_gifts.html">ã‚®ãƒ•ãƒˆã‚’é€ã‚‹</a></li>
                    <li><a href="mypage.html">ãƒã‚¤ãƒšãƒ¼ã‚¸</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main class="main-content">
        <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="hero">
            <h1>é€å—ä¿¡å±¥æ­´</h1>
            <p>ã‚ãªãŸã®GIFTã®é€å—ä¿¡å±¥æ­´ã‚’ç¢ºèªã§ãã¾ã™</p>
        </section>

        <!-- çµ±è¨ˆã‚µãƒãƒªãƒ¼ -->
        <section class="history-summary">
            <div class="grid grid-3">
                <div class="card stat-card">
                    <div class="icon">ğŸ“¤</div>
                    <h3>é€ä¿¡ã—ãŸã‚®ãƒ•ãƒˆ</h3>
                    <div class="stat-number">5</div>
                    <p>ä»¶</p>
                </div>
                <div class="card stat-card">
                    <div class="icon">ğŸ“¥</div>
                    <h3>å—ä¿¡ã—ãŸã‚®ãƒ•ãƒˆ</h3>
                    <div class="stat-number">3</div>
                    <p>ä»¶</p>
                </div>
                <div class="card stat-card">
                    <div class="icon">ğŸ’</div>
                    <h3>ç·ã‚®ãƒ•ãƒˆé‡‘é¡</h3>
                    <div class="stat-number">Â¥125,000</div>
                    <p>ï¼ˆé€ä¿¡åˆ†ï¼‰</p>
                </div>
            </div>
        </section>

        <!-- ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒŠ -->
        <section class="tab-container">
            <div class="tab-buttons">
                <button class="tab-button active" data-tab="sent-tab">é€ä¿¡ã—ãŸã‚®ãƒ•ãƒˆ</button>
                <button class="tab-button" data-tab="received-tab">å—ä¿¡ã—ãŸã‚®ãƒ•ãƒˆ</button>
            </div>

            <!-- é€ä¿¡ã—ãŸã‚®ãƒ•ãƒˆã‚¿ãƒ– -->
            <div id="sent-tab" class="tab-content active">
                <div class="card">
                    <h2>é€ä¿¡ã—ãŸã‚®ãƒ•ãƒˆ</h2>
                    <p>ã‚ãªãŸãŒé€ä¿¡ã—ãŸã‚®ãƒ•ãƒˆã®å±¥æ­´ã§ã™</p>
                    
                    <div class="table-container">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>æ—¥ä»˜</th>
                                    <th>ã‚®ãƒ•ãƒˆå</th>
                                    <th>ç›¸æ‰‹</th>
                                    <th>é‡‘é¡</th>
                                    <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                                    <th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                                </tr>
                            </thead>
                            <tbody id="sent-history">
                                <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- å—ä¿¡ã—ãŸã‚®ãƒ•ãƒˆã‚¿ãƒ– -->
            <div id="received-tab" class="tab-content">
                <div class="card">
                    <h2>å—ä¿¡ã—ãŸã‚®ãƒ•ãƒˆ</h2>
                    <p>ã‚ãªãŸãŒå—ä¿¡ã—ãŸã‚®ãƒ•ãƒˆã®å±¥æ­´ã§ã™</p>
                    
                    <div class="table-container">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>æ—¥ä»˜</th>
                                    <th>ã‚®ãƒ•ãƒˆå</th>
                                    <th>é€ä¿¡è€…</th>
                                    <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                                    <th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                                </tr>
                            </thead>
                            <tbody id="received-history">
                                <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ»æ¤œç´¢ -->
        <section class="filter-search">
            <div class="card">
                <h2>å±¥æ­´ã®æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</h2>
                <div class="grid grid-3">
                    <div class="form-group">
                        <label for="date-filter">æœŸé–“</label>
                        <select id="date-filter" class="form-control">
                            <option value="all">ã™ã¹ã¦</option>
                            <option value="1month">éå»1ãƒ¶æœˆ</option>
                            <option value="3months">éå»3ãƒ¶æœˆ</option>
                            <option value="6months">éå»6ãƒ¶æœˆ</option>
                            <option value="1year">éå»1å¹´</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="status-filter">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</label>
                        <select id="status-filter" class="form-control">
                            <option value="all">ã™ã¹ã¦</option>
                            <option value="used">ä½¿ç”¨æ¸ˆã¿</option>
                            <option value="unused">æœªä½¿ç”¨</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="search-input">æ¤œç´¢</label>
                        <input type="text" id="search-input" class="form-control" placeholder="ã‚®ãƒ•ãƒˆåã‚„ç›¸æ‰‹ã®åå‰ã§æ¤œç´¢">
                    </div>
                </div>
                <div class="filter-actions">
                    <button class="btn btn-secondary" onclick="applyFilters()">ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨</button>
                    <button class="btn btn-warning" onclick="resetFilters()">ãƒªã‚»ãƒƒãƒˆ</button>
                </div>
            </div>
        </section>

        <!-- ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ -->
        <section class="export-section">
            <div class="card">
                <h2>å±¥æ­´ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</h2>
                <p>å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã‚’CSVãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™</p>
                <div class="export-options">
                    <button class="btn btn-success" onclick="exportHistory('sent')">é€ä¿¡å±¥æ­´ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
                    <button class="btn btn-success" onclick="exportHistory('received')">å—ä¿¡å±¥æ­´ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
                    <button class="btn btn-secondary" onclick="exportHistory('all')">å…¨å±¥æ­´ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
                </div>
            </div>
        </section>

        <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="history-actions">
            <div class="card text-center">
                <h2>æ–°ã—ã„ã‚®ãƒ•ãƒˆã‚’é€ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ</h2>
                <p>å¤§åˆ‡ãªäººã¸ã®æƒ³ã„ã‚’ã€å¥åº·ã¨ã„ã†å½¢ã§è¡¨ç¾ã—ã¾ã—ã‚‡ã†</p>
                <div class="action-buttons">
                    <a href="send_gifts.html" class="btn btn-success">ã‚®ãƒ•ãƒˆã‚’é€ã‚‹</a>
                    <a href="mypage.html" class="btn btn-secondary">ãƒã‚¤ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>
                </div>
            </div>
        </section>
    </main>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2024 GIFT. All rights reserved.</p>
            <p>å¤§åˆ‡ãªäººã¸å¥åº·ã‚’è´ˆã‚‹ - GIFT</p>
        </div>
    </footer>

    <script src="js/script.js"></script>
    <script>
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initHistoryPage();
            initTabs();
        });

        // å±¥æ­´ãƒšãƒ¼ã‚¸ã®åˆæœŸåŒ–
        function initHistoryPage() {
            displayHistory('sent-history', 'sent');
            displayHistory('received-history', 'received');
        }

        // ã‚¿ãƒ–æ©Ÿèƒ½ã®åˆæœŸåŒ–
        function initTabs() {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const target = button.getAttribute('data-tab');
                    
                    // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¯ãƒ©ã‚¹ã‚’åˆ‡ã‚Šæ›¿ãˆ
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    button.classList.add('active');
                    document.getElementById(target).classList.add('active');
                });
            });
        }

        // å±¥æ­´è¡¨ç¤ºï¼ˆæ‹¡å¼µç‰ˆï¼‰
        function displayHistory(containerId, type = 'all') {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            let filteredHistory = giftData.history;
            if (type !== 'all') {
                filteredHistory = giftData.history.filter(item => item.type === type);
            }
            
            const historyHTML = filteredHistory.map(item => {
                const date = new Date(item.date).toLocaleDateString('ja-JP');
                const statusClass = item.status === 'ä½¿ç”¨æ¸ˆã¿' ? 'badge-success' : 'badge-warning';
                
                if (item.type === 'sent') {
                    const gift = giftData.gifts.find(g => g.name === item.giftName);
                    const price = gift ? gift.price : 0;
                    
                    return `
                        <tr>
                            <td>${date}</td>
                            <td>${item.giftName}</td>
                            <td>${item.recipient}</td>
                            <td>Â¥${price.toLocaleString()}</td>
                            <td><span class="badge ${statusClass}">${item.status}</span></td>
                            <td>
                                <button class="btn btn-secondary btn-sm" onclick="viewDetails(${item.id})">è©³ç´°</button>
                                <button class="btn btn-warning btn-sm" onclick="resendGift(${item.id})">å†é€</button>
                            </td>
                        </tr>
                    `;
                } else {
                    return `
                        <tr>
                            <td>${date}</td>
                            <td>${item.giftName}</td>
                            <td>${item.sender}</td>
                            <td><span class="badge ${statusClass}">${item.status}</span></td>
                            <td>
                                <button class="btn btn-secondary btn-sm" onclick="viewDetails(${item.id})">è©³ç´°</button>
                                ${item.status === 'æœªä½¿ç”¨' ? `<button class="btn btn-success btn-sm" onclick="useGift(${item.id})">ä½¿ç”¨ã™ã‚‹</button>` : ''}
                            </td>
                        </tr>
                    `;
                }
            }).join('');
            
            container.innerHTML = historyHTML;
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
        function applyFilters() {
            const dateFilter = document.getElementById('date-filter').value;
            const statusFilter = document.getElementById('status-filter').value;
            const searchInput = document.getElementById('search-input').value;
            
            console.log('ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨:', { dateFilter, statusFilter, searchInput });
            
            // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¿½åŠ 
            showAlert('ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãŒé©ç”¨ã•ã‚Œã¾ã—ãŸ', 'info');
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒªã‚»ãƒƒãƒˆ
        function resetFilters() {
            document.getElementById('date-filter').value = 'all';
            document.getElementById('status-filter').value = 'all';
            document.getElementById('search-input').value = '';
            
            showAlert('ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã—ãŸ', 'info');
        }

        // å±¥æ­´ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
        function exportHistory(type) {
            console.log('ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ:', type);
            showAlert(`${type === 'all' ? 'å…¨å±¥æ­´' : type === 'sent' ? 'é€ä¿¡å±¥æ­´' : 'å—ä¿¡å±¥æ­´'}ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚’é–‹å§‹ã—ã¾ã—ãŸ`, 'success');
        }

        // è©³ç´°è¡¨ç¤º
        function viewDetails(id) {
            const item = giftData.history.find(h => h.id === id);
            if (item) {
                alert(`è©³ç´°æƒ…å ±:\nã‚®ãƒ•ãƒˆ: ${item.giftName}\næ—¥ä»˜: ${item.date}\nã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ${item.status}`);
            }
        }

        // ã‚®ãƒ•ãƒˆå†é€
        function resendGift(id) {
            const item = giftData.history.find(h => h.id === id);
            if (item) {
                if (confirm(`${item.giftName}ã‚’${item.recipient}ã«å†é€ã—ã¾ã™ã‹ï¼Ÿ`)) {
                    showAlert('ã‚®ãƒ•ãƒˆã®å†é€ã‚’é–‹å§‹ã—ã¾ã—ãŸ', 'success');
                }
            }
        }

        // ã‚®ãƒ•ãƒˆä½¿ç”¨
        function useGift(id) {
            const item = giftData.history.find(h => h.id === id);
            if (item) {
                if (confirm(`${item.giftName}ã‚’ä½¿ç”¨ã—ã¾ã™ã‹ï¼Ÿ`)) {
                    showAlert('ã‚®ãƒ•ãƒˆã®ä½¿ç”¨ã‚’é–‹å§‹ã—ã¾ã—ãŸ', 'success');
                }
            }
        }
    </script>

    <style>
        .stat-card {
            text-align: center;
            padding: 2rem;
        }

        .stat-card .icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 0.5rem;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 1rem;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .history-table th,
        .history-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e1e5e9;
        }

        .history-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
        }

        .history-table tr:hover {
            background-color: #f8f9fa;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
            margin: 0.25rem;
        }

        .filter-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1rem;
        }

        .export-options {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .action-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1rem;
        }

        .text-center {
            text-align: center;
        }

        .section-title {
            text-align: center;
            margin-bottom: 2rem;
            color: #333;
            font-size: 2rem;
        }
    </style>
</body>
</html> 