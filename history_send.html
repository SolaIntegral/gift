<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å±¥æ­´ - GIFT</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ</text></svg>">
</head>
<body>
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="header">
        <div class="header-content">
            <a href="index.html" class="logo">GIFT</a>
            <div style="width: 60px;"></div> <!-- ä¸­å¤®æƒãˆã®ãŸã‚ã®ã‚¹ãƒšãƒ¼ã‚µãƒ¼ -->
        </div>
    </header>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main class="main-content">
        <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="hero">
            <div class="hero-content">
                <h1>å±¥æ­´</h1>
                <p>é€ä¿¡ãƒ»å—ä¿¡ã—ãŸã‚®ãƒ•ãƒˆã®å±¥æ­´ã‚’ç¢ºèªã§ãã¾ã™</p>
            </div>
        </section>

        <!-- ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
        <section class="card">
            <div class="tab-navigation">
                <button class="tab-button active" onclick="switchTab('all')">ã™ã¹ã¦</button>
                <button class="tab-button" onclick="switchTab('sent')">é€ä¿¡å±¥æ­´</button>
                <button class="tab-button" onclick="switchTab('received')">å—ä¿¡å±¥æ­´</button>
            </div>
        </section>

        <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ»æ¤œç´¢ -->
        <section class="card">
            <div class="search-filter">
                <div class="search-box">
                    <input type="text" id="search-input" placeholder="ã‚®ãƒ•ãƒˆåã‚„ç›¸æ‰‹ã®åå‰ã§æ¤œç´¢..." class="form-control">
                    <button onclick="searchHistory()" class="btn btn-secondary">æ¤œç´¢</button>
                </div>
                <div class="filter-options">
                    <select id="status-filter" class="form-control" onchange="filterHistory()">
                        <option value="">ã™ã¹ã¦ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</option>
                        <option value="completed">å®Œäº†</option>
                        <option value="pending">å‡¦ç†ä¸­</option>
                        <option value="cancelled">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</option>
                    </select>
                    <select id="date-filter" class="form-control" onchange="filterHistory()">
                        <option value="">ã™ã¹ã¦ã®æœŸé–“</option>
                        <option value="today">ä»Šæ—¥</option>
                        <option value="week">ä»Šé€±</option>
                        <option value="month">ä»Šæœˆ</option>
                        <option value="year">ä»Šå¹´</option>
                    </select>
                </div>
            </div>
        </section>

        <!-- å±¥æ­´ä¸€è¦§ -->
        <section class="card">
            <div class="history-header">
                <h2>å±¥æ­´ä¸€è¦§</h2>
                <div class="history-actions">
                    <button onclick="exportHistory()" class="btn btn-secondary">ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
                    <button onclick="clearFilters()" class="btn btn-secondary">ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚¯ãƒªã‚¢</button>
                </div>
            </div>
            
            <div id="history-container">
                <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
            </div>
            
            <div id="no-results" style="display: none; text-align: center; padding: 2rem;">
                <div class="icon" style="font-size: 3rem; color: var(--color-text-secondary);">ğŸ”</div>
                <h3>è©²å½“ã™ã‚‹å±¥æ­´ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</h3>
                <p>æ¤œç´¢æ¡ä»¶ã‚’å¤‰æ›´ã—ã¦ãŠè©¦ã—ãã ã•ã„</p>
            </div>
        </section>

        <!-- çµ±è¨ˆæƒ…å ± -->
        <section class="card">
            <h2>çµ±è¨ˆæƒ…å ±</h2>
            <div class="grid grid-3">
                <div style="background: var(--color-background-light); padding: 1.5rem; border-radius: var(--border-radius-md); text-align: center;">
                    <div class="icon" style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ“¤</div>
                    <h3>é€ä¿¡ç·æ•°</h3>
                    <div style="font-size: 2rem; font-weight: bold; color: var(--color-orange-primary);">12</div>
                    <p>ä»¶</p>
                </div>
                <div style="background: var(--color-background-light); padding: 1.5rem; border-radius: var(--border-radius-md); text-align: center;">
                    <div class="icon" style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ“¥</div>
                    <h3>å—ä¿¡ç·æ•°</h3>
                    <div style="font-size: 2rem; font-weight: bold; color: var(--color-orange-primary);">5</div>
                    <p>ä»¶</p>
                </div>
                <div style="background: var(--color-background-light); padding: 1.5rem; border-radius: var(--border-radius-md); text-align: center;">
                    <div class="icon" style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ’°</div>
                    <h3>ç·åˆ©ç”¨é‡‘é¡</h3>
                    <div style="font-size: 2rem; font-weight: bold; color: var(--color-orange-primary);">Â¥285,000</div>
                </div>
            </div>
        </section>
    </main>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
    <nav class="footer-nav">
        <div class="footer-nav-content">
            <a href="index.html" class="footer-nav-item">
                <div class="footer-nav-icon">ğŸ </div>
                <div class="footer-nav-text">ãƒ›ãƒ¼ãƒ </div>
            </a>
            <a href="send_gifts.html" class="footer-nav-item">
                <div class="footer-nav-icon">ğŸ</div>
                <div class="footer-nav-text">ã‚®ãƒ•ãƒˆ</div>
            </a>
            <a href="mypage.html" class="footer-nav-item">
                <div class="footer-nav-icon">ğŸ‘¤</div>
                <div class="footer-nav-text">ãƒã‚¤ãƒšãƒ¼ã‚¸</div>
            </a>
            <a href="history_send.html" class="footer-nav-item active">
                <div class="footer-nav-icon">ğŸ“‹</div>
                <div class="footer-nav-text">å±¥æ­´</div>
            </a>
        </div>
    </nav>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <footer class="footer">
        <p>&copy; 2024 GIFT. All rights reserved.</p>
    </footer>

    <script src="js/script.js"></script>
    <script>
        // å±¥æ­´ãƒ‡ãƒ¼ã‚¿
        const historyData = [
            {
                id: 1,
                type: 'sent',
                giftName: 'å¥åº·è¨ºæ–­ãƒ‘ãƒƒã‚¯A',
                recipient: 'ç”°ä¸­èŠ±å­',
                amount: 15000,
                date: '2024-01-15',
                status: 'completed',
                icon: 'ğŸ’Š'
            },
            {
                id: 2,
                type: 'sent',
                giftName: 'å¥åº·è¨ºæ–­ãƒ‘ãƒƒã‚¯B',
                recipient: 'ä½è—¤æ¬¡éƒ',
                amount: 25000,
                date: '2024-01-10',
                status: 'completed',
                icon: 'â¤ï¸'
            },
            {
                id: 3,
                type: 'received',
                giftName: 'å¥åº·è¨ºæ–­ãƒ‘ãƒƒã‚¯A',
                sender: 'å±±ç”°ç¾å’²',
                amount: 15000,
                date: '2024-01-12',
                status: 'completed',
                icon: 'ğŸ’Š'
            },
            {
                id: 4,
                type: 'received',
                giftName: 'å¥åº·ç›¸è«‡ãƒã‚±ãƒƒãƒˆ',
                sender: 'é«˜æ©‹ä¸€éƒ',
                amount: 8000,
                date: '2024-01-08',
                status: 'completed',
                icon: 'ğŸ‘¨â€âš•ï¸'
            },
            {
                id: 5,
                type: 'sent',
                giftName: 'æ „é¤ŠæŒ‡å°ã‚»ãƒƒã‚·ãƒ§ãƒ³',
                recipient: 'éˆ´æœ¨æµå­',
                amount: 5000,
                date: '2024-01-05',
                status: 'pending',
                icon: 'ğŸ¥—'
            },
            {
                id: 6,
                type: 'sent',
                giftName: 'ã‚¹ãƒˆãƒ¬ã‚¹ã‚±ã‚¢ã‚»ãƒƒã‚·ãƒ§ãƒ³',
                recipient: 'æ¸¡è¾ºå¥å¤ª',
                amount: 12000,
                date: '2024-01-03',
                status: 'completed',
                icon: 'ğŸ§˜â€â™€ï¸'
            },
            {
                id: 7,
                type: 'received',
                giftName: 'å¥åº·è¨ºæ–­ãƒ‘ãƒƒã‚¯C',
                sender: 'ä¼Šè—¤éº»ç¾',
                amount: 35000,
                date: '2024-01-01',
                status: 'completed',
                icon: 'ğŸŒŸ'
            },
            {
                id: 8,
                type: 'sent',
                giftName: 'å¥åº·è¨ºæ–­ãƒ‘ãƒƒã‚¯A',
                recipient: 'ä¸­æ‘é›…å­',
                amount: 15000,
                date: '2023-12-28',
                status: 'cancelled',
                icon: 'ğŸ’Š'
            }
        ];

        let currentTab = 'all';
        let filteredHistory = [...historyData];

        // ãƒšãƒ¼ã‚¸å›ºæœ‰ã®JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            displayHistory(filteredHistory);
        });

        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
        function switchTab(tab) {
            currentTab = tab;
            
            // ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’æ›´æ–°
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // å±¥æ­´ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
            filterHistory();
        }

        // å±¥æ­´æ¤œç´¢
        function searchHistory() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            
            filteredHistory = historyData.filter(item => {
                const matchesTab = currentTab === 'all' || item.type === currentTab;
                const matchesSearch = item.giftName.toLowerCase().includes(searchTerm) ||
                                    (item.type === 'sent' ? item.recipient : item.sender).toLowerCase().includes(searchTerm);
                
                return matchesTab && matchesSearch;
            });
            
            displayHistory(filteredHistory);
        }

        // å±¥æ­´ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        function filterHistory() {
            const statusFilter = document.getElementById('status-filter').value;
            const dateFilter = document.getElementById('date-filter').value;
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            
            filteredHistory = historyData.filter(item => {
                // ã‚¿ãƒ–ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                const matchesTab = currentTab === 'all' || item.type === currentTab;
                
                // æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                const matchesSearch = searchTerm === '' || 
                    item.giftName.toLowerCase().includes(searchTerm) ||
                    (item.type === 'sent' ? item.recipient : item.sender).toLowerCase().includes(searchTerm);
                
                // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                const matchesStatus = statusFilter === '' || item.status === statusFilter;
                
                // æ—¥ä»˜ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                const itemDate = new Date(item.date);
                const today = new Date();
                let matchesDate = true;
                
                if (dateFilter === 'today') {
                    matchesDate = itemDate.toDateString() === today.toDateString();
                } else if (dateFilter === 'week') {
                    const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
                    matchesDate = itemDate >= weekAgo;
                } else if (dateFilter === 'month') {
                    const monthAgo = new Date(today.getFullYear(), today.getMonth(), 1);
                    matchesDate = itemDate >= monthAgo;
                } else if (dateFilter === 'year') {
                    const yearAgo = new Date(today.getFullYear(), 0, 1);
                    matchesDate = itemDate >= yearAgo;
                }
                
                return matchesTab && matchesSearch && matchesStatus && matchesDate;
            });
            
            displayHistory(filteredHistory);
        }

        // å±¥æ­´è¡¨ç¤º
        function displayHistory(history) {
            const container = document.getElementById('history-container');
            const noResults = document.getElementById('no-results');
            
            if (history.length === 0) {
                container.style.display = 'none';
                noResults.style.display = 'block';
                return;
            }
            
            container.style.display = 'block';
            noResults.style.display = 'none';
            
            const historyHTML = history.map(item => {
                const date = new Date(item.date).toLocaleDateString('ja-JP');
                const partner = item.type === 'sent' ? item.recipient : item.sender;
                const statusClass = getStatusClass(item.status);
                const statusText = getStatusText(item.status);
                
                return `
                    <div class="history-item">
                        <div class="history-icon">${item.icon}</div>
                        <div class="history-details">
                            <h3>${item.giftName}</h3>
                            <p><strong>${item.type === 'sent' ? 'é€ä¿¡å…ˆ:' : 'é€ä¿¡è€…:'}</strong> ${partner}</p>
                            <p><strong>é‡‘é¡:</strong> Â¥${item.amount.toLocaleString()}</p>
                            <p><strong>æ—¥ä»˜:</strong> ${date}</p>
                            <span class="badge ${statusClass}">${statusText}</span>
                        </div>
                        <div class="history-actions">
                            <button onclick="viewDetails(${item.id})" class="btn btn-secondary">è©³ç´°</button>
                        </div>
                    </div>
                `;
            }).join('');
            
            container.innerHTML = historyHTML;
        }

        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¯ãƒ©ã‚¹å–å¾—
        function getStatusClass(status) {
            switch (status) {
                case 'completed': return 'badge-success';
                case 'pending': return 'badge-warning';
                case 'cancelled': return 'badge-danger';
                default: return 'badge-secondary';
            }
        }

        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ†ã‚­ã‚¹ãƒˆå–å¾—
        function getStatusText(status) {
            switch (status) {
                case 'completed': return 'å®Œäº†';
                case 'pending': return 'å‡¦ç†ä¸­';
                case 'cancelled': return 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«';
                default: return 'ä¸æ˜';
            }
        }

        // è©³ç´°è¡¨ç¤º
        function viewDetails(id) {
            const item = historyData.find(h => h.id === id);
            if (!item) return;
            
            const details = `
                ã‚®ãƒ•ãƒˆå: ${item.giftName}
                ${item.type === 'sent' ? 'é€ä¿¡å…ˆ' : 'é€ä¿¡è€…'}: ${item.type === 'sent' ? item.recipient : item.sender}
                é‡‘é¡: Â¥${item.amount.toLocaleString()}
                æ—¥ä»˜: ${new Date(item.date).toLocaleDateString('ja-JP')}
                ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ${getStatusText(item.status)}
            `;
            
            alert(details);
        }

        // å±¥æ­´ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
        function exportHistory() {
            const csvContent = generateCSV(filteredHistory);
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `gift_history_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // CSVç”Ÿæˆ
        function generateCSV(history) {
            const headers = ['ID', 'ã‚¿ã‚¤ãƒ—', 'ã‚®ãƒ•ãƒˆå', 'ç›¸æ‰‹', 'é‡‘é¡', 'æ—¥ä»˜', 'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹'];
            const rows = history.map(item => [
                item.id,
                item.type === 'sent' ? 'é€ä¿¡' : 'å—ä¿¡',
                item.giftName,
                item.type === 'sent' ? item.recipient : item.sender,
                item.amount,
                item.date,
                getStatusText(item.status)
            ]);
            
            return [headers, ...rows].map(row => row.join(',')).join('\n');
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚¯ãƒªã‚¢
        function clearFilters() {
            document.getElementById('search-input').value = '';
            document.getElementById('status-filter').value = '';
            document.getElementById('date-filter').value = '';
            filteredHistory = [...historyData];
            displayHistory(filteredHistory);
        }
    </script>
</body>
</html> 