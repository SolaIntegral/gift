<template>
  <div class="gift-consultation">
    <div class="consultation-header">
      <h2>ğŸ å¥åº·ã‚®ãƒ•ãƒˆç›¸è«‡</h2>
      <p>ã„ãã¤ã‹ã®è³ªå•ã«ãŠç­”ãˆã„ãŸã ãã€æœ€é©ãªå¥åº·ã‚®ãƒ•ãƒˆã‚’ã”ææ¡ˆã„ãŸã—ã¾ã™</p>
    </div>

    <!-- ç›¸è«‡ãƒ•ã‚©ãƒ¼ãƒ  -->
    <form v-if="!showRecommendations" @submit.prevent="findGifts" class="consultation-form">
      <div class="form-section">
        <h3>å—å–äººã«ã¤ã„ã¦</h3>
        
        <div class="form-group">
          <label for="recipient-age">å¹´é½¢ *</label>
          <select id="recipient-age" v-model="answers.age" required class="form-control">
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option value="20-29">20ä»£</option>
            <option value="30-39">30ä»£</option>
            <option value="40-49">40ä»£</option>
            <option value="50-59">50ä»£</option>
            <option value="60-69">60ä»£</option>
            <option value="70+">70ä»£ä»¥ä¸Š</option>
          </select>
        </div>

        <div class="form-group">
          <label for="recipient-gender">æ€§åˆ¥</label>
          <select id="recipient-gender" v-model="answers.gender" class="form-control">
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option value="male">ç”·æ€§</option>
            <option value="female">å¥³æ€§</option>
            <option value="other">ãã®ä»–</option>
          </select>
        </div>

        <div class="form-group">
          <label for="relationship">é–¢ä¿‚æ€§</label>
          <select id="relationship" v-model="answers.relationship" class="form-control">
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option value="family">å®¶æ—</option>
            <option value="friend">å‹äºº</option>
            <option value="colleague">åŒåƒš</option>
            <option value="partner">ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼</option>
            <option value="other">ãã®ä»–</option>
          </select>
        </div>
      </div>

      <div class="form-section">
        <h3>äºˆç®—ãƒ»é–¢å¿ƒäº‹</h3>
        
        <div class="form-group">
          <label for="budget">äºˆç®— *</label>
          <select id="budget" v-model="answers.budget" required class="form-control">
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option value="5000-10000">5,000å††ã€œ10,000å††</option>
            <option value="10000-20000">10,000å††ã€œ20,000å††</option>
            <option value="20000-30000">20,000å††ã€œ30,000å††</option>
            <option value="30000-50000">30,000å††ã€œ50,000å††</option>
            <option value="50000+">50,000å††ä»¥ä¸Š</option>
          </select>
        </div>

        <div class="form-group">
          <label>å¥åº·ã¸ã®é–¢å¿ƒäº‹ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</label>
          <div class="checkbox-group">
            <label class="checkbox-item">
              <input type="checkbox" v-model="answers.healthConcerns" value="general-health">
              <span class="checkmark"></span>
              ä¸€èˆ¬çš„ãªå¥åº·ç®¡ç†
            </label>
            <label class="checkbox-item">
              <input type="checkbox" v-model="answers.healthConcerns" value="dental-care">
              <span class="checkmark"></span>
              æ­¯ç§‘ã‚±ã‚¢
            </label>
            <label class="checkbox-item">
              <input type="checkbox" v-model="answers.healthConcerns" value="beauty-care">
              <span class="checkmark"></span>
              ç¾å®¹ãƒ»ã‚¹ã‚­ãƒ³ã‚±ã‚¢
            </label>
            <label class="checkbox-item">
              <input type="checkbox" v-model="answers.healthConcerns" value="fitness">
              <span class="checkmark"></span>
              ãƒ•ã‚£ãƒƒãƒˆãƒã‚¹ãƒ»é‹å‹•
            </label>
            <label class="checkbox-item">
              <input type="checkbox" v-model="answers.healthConcerns" value="nutrition">
              <span class="checkmark"></span>
              æ „é¤Šãƒ»é£Ÿäº‹
            </label>
            <label class="checkbox-item">
              <input type="checkbox" v-model="answers.healthConcerns" value="mental-health">
              <span class="checkmark"></span>
              ãƒ¡ãƒ³ã‚¿ãƒ«ãƒ˜ãƒ«ã‚¹
            </label>
          </div>
        </div>

        <div class="form-group">
          <label for="occasion">è´ˆã‚‹æ©Ÿä¼š</label>
          <select id="occasion" v-model="answers.occasion" class="form-control">
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option value="birthday">èª•ç”Ÿæ—¥</option>
            <option value="anniversary">è¨˜å¿µæ—¥</option>
            <option value="christmas">ã‚¯ãƒªã‚¹ãƒã‚¹</option>
            <option value="newyear">ãŠæ­£æœˆ</option>
            <option value="graduation">å’æ¥­ãƒ»å…¥å­¦</option>
            <option value="other">ãã®ä»–</option>
          </select>
        </div>
      </div>

      <div class="form-actions">
        <BaseButton 
          type="submit" 
          :loading="loading"
          :disabled="!isFormValid"
          class="submit-button"
        >
          {{ loading ? 'æ¤œç´¢ä¸­...' : 'ã‚®ãƒ•ãƒˆã‚’ææ¡ˆã—ã¦ã‚‚ã‚‰ã†' }}
        </BaseButton>
      </div>
    </form>

    <!-- ã‚®ãƒ•ãƒˆæ¨è–¦çµæœ -->
    <div v-if="showRecommendations" class="recommendations">
      <div class="recommendations-header">
        <h3>ğŸ¯ ã‚ãªãŸã«åˆã†ã‚®ãƒ•ãƒˆ</h3>
        <p>æ¡ä»¶ã«åˆã†{{ filteredGifts.length }}ä»¶ã®ã‚®ãƒ•ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ</p>
        <BaseButton @click="backToForm" variant="outline" size="sm">
          â† æ¡ä»¶ã‚’å¤‰æ›´ã™ã‚‹
        </BaseButton>
      </div>

      <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚ªãƒ—ã‚·ãƒ§ãƒ³ -->
      <div class="filter-options">
        <div class="filter-group">
          <label>ã‚«ãƒ†ã‚´ãƒªã§çµã‚Šè¾¼ã¿:</label>
          <div class="filter-buttons">
            <button 
              v-for="category in availableCategories" 
              :key="category.value"
              @click="toggleCategoryFilter(category.value)"
              :class="['filter-btn', { active: selectedCategories.includes(category.value) }]"
            >
              {{ category.label }}
            </button>
          </div>
        </div>
      </div>

      <!-- ã‚®ãƒ•ãƒˆä¸€è¦§ -->
      <div v-if="filteredGifts.length > 0" class="gifts-grid">
        <div 
          v-for="gift in filteredGifts" 
          :key="gift.id"
          class="gift-card"
          @click="selectGift(gift)"
        >
          <div class="gift-image">
            <span class="gift-icon">{{ getGiftIcon(gift.category) }}</span>
          </div>
          <div class="gift-info">
            <h4 class="gift-name">{{ gift.name }}</h4>
            <p class="gift-description">{{ gift.description }}</p>
            <div class="gift-meta">
              <span class="gift-price">Â¥{{ gift.price.toLocaleString() }}</span>
              <span class="gift-category">{{ getCategoryLabel(gift.category) }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- ã‚®ãƒ•ãƒˆãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ -->
      <div v-else class="no-gifts">
        <p>æ¡ä»¶ã«åˆã†ã‚®ãƒ•ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>
        <p>æ¡ä»¶ã‚’å¤‰æ›´ã—ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚</p>
        <BaseButton @click="backToForm" class="mt-2">
          æ¡ä»¶ã‚’å¤‰æ›´ã™ã‚‹
        </BaseButton>
      </div>
    </div>

    <!-- é¸æŠã•ã‚ŒãŸã‚®ãƒ•ãƒˆã®è©³ç´° -->
    <div v-if="selectedGift" class="selected-gift-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>é¸æŠã•ã‚ŒãŸã‚®ãƒ•ãƒˆ</h3>
          <button @click="selectedGift = null" class="close-btn">&times;</button>
        </div>
        <div class="gift-detail">
          <div class="gift-image-large">
            <span class="gift-icon-large">{{ getGiftIcon(selectedGift.category) }}</span>
          </div>
          <h4>{{ selectedGift.name }}</h4>
          <p>{{ selectedGift.description }}</p>
          <div class="gift-price-large">Â¥{{ selectedGift.price.toLocaleString() }}</div>
          <div class="gift-actions">
            <BaseButton @click="proceedToOrder" class="order-btn">
              æ³¨æ–‡ã«é€²ã‚€
            </BaseButton>
            <BaseButton @click="selectedGift = null" variant="outline">
              ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            </BaseButton>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, reactive, computed, onMounted } from 'vue'
import { useRouter } from 'vue-router'
import BaseButton from '@/components/ui/BaseButton.vue'
import type { Gift, ConsultationAnswers } from '@/types'

const router = useRouter()

// çŠ¶æ…‹ç®¡ç†
const loading = ref(false)
const showRecommendations = ref(false)
const selectedGift = ref<Gift | null>(null)
const selectedCategories = ref<string[]>([])

// ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿
const answers = reactive<ConsultationAnswers>({
  age: '',
  gender: '',
  relationship: '',
  budget: '',
  healthConcerns: [],
  occasion: '',
})

// åˆ©ç”¨å¯èƒ½ãªã‚®ãƒ•ãƒˆãƒ‡ãƒ¼ã‚¿
const availableGifts: Gift[] = [
  {
    id: 'gift-1',
    name: 'ç·åˆå¥åº·è¨ºæ–­ãƒ‘ãƒƒã‚¯',
    description: 'åŸºæœ¬æ¤œæŸ»ã‹ã‚‰è©³ç´°æ¤œæŸ»ã¾ã§ã€å¥åº·çŠ¶æ…‹ã‚’ç·åˆçš„ã«ãƒã‚§ãƒƒã‚¯',
    price: 15000,
    category: 'health_checkup',
    partnerId: 'partner-1',
    status: 'active',
    createdAt: new Date().toISOString()
  },
  {
    id: 'gift-2',
    name: 'æ­¯ç§‘æ¤œè¨ºãƒ»ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°',
    description: 'è™«æ­¯ãƒã‚§ãƒƒã‚¯ã¨æ­¯çŸ³é™¤å»ã§ã€ãŠå£ã®å¥åº·ã‚’ã‚µãƒãƒ¼ãƒˆ',
    price: 8000,
    category: 'dental_care',
    partnerId: 'partner-2',
    status: 'active',
    createdAt: new Date().toISOString()
  },
  {
    id: 'gift-3',
    name: 'è‚Œè¨ºæ–­ãƒ»ç¾å®¹ç›¸è«‡',
    description: 'è‚Œã®çŠ¶æ…‹ãƒã‚§ãƒƒã‚¯ã¨ç¾å®¹ã‚¢ãƒ‰ãƒã‚¤ã‚¹',
    price: 12000,
    category: 'beauty_treatment',
    partnerId: 'partner-3',
    status: 'active',
    createdAt: new Date().toISOString()
  },
  {
    id: 'gift-4',
    name: 'ãƒ•ã‚£ãƒƒãƒˆãƒã‚¹è©•ä¾¡ãƒ»ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°',
    description: 'ä½“åŠ›æ¸¬å®šã¨å€‹äººã«åˆã£ãŸé‹å‹•ãƒ—ãƒ©ãƒ³',
    price: 18000,
    category: 'fitness',
    partnerId: 'partner-4',
    status: 'active',
    createdAt: new Date().toISOString()
  },
  {
    id: 'gift-5',
    name: 'æ „é¤Šç›¸è«‡ãƒ»é£Ÿäº‹ãƒ—ãƒ©ãƒ³',
    description: 'å€‹äººã«åˆã‚ã›ãŸæ „é¤ŠæŒ‡å°ã¨é£Ÿäº‹ãƒ—ãƒ©ãƒ³ä½œæˆ',
    price: 10000,
    category: 'nutrition',
    partnerId: 'partner-5',
    status: 'active',
    createdAt: new Date().toISOString()
  },
  {
    id: 'gift-6',
    name: 'ã‚¹ãƒˆãƒ¬ã‚¹ãƒã‚§ãƒƒã‚¯ãƒ»ãƒ¡ãƒ³ã‚¿ãƒ«ã‚±ã‚¢',
    description: 'ã‚¹ãƒˆãƒ¬ã‚¹åº¦æ¸¬å®šã¨ãƒ¡ãƒ³ã‚¿ãƒ«ãƒ˜ãƒ«ã‚¹ã‚µãƒãƒ¼ãƒˆ',
    price: 15000,
    category: 'mental_health',
    partnerId: 'partner-6',
    status: 'active',
    createdAt: new Date().toISOString()
  },
  {
    id: 'gift-7',
    name: 'éª¨å¯†åº¦æ¸¬å®šãƒ»éª¨ç²—é¬†ç—‡äºˆé˜²',
    description: 'éª¨ã®å¥åº·çŠ¶æ…‹ãƒã‚§ãƒƒã‚¯ã¨äºˆé˜²ã‚¢ãƒ‰ãƒã‚¤ã‚¹',
    price: 12000,
    category: 'health_checkup',
    partnerId: 'partner-7',
    status: 'active',
    createdAt: new Date().toISOString()
  },
  {
    id: 'gift-8',
    name: 'ãƒ›ãƒ«ãƒ¢ãƒ³æ¤œæŸ»ãƒ»æ›´å¹´æœŸã‚µãƒãƒ¼ãƒˆ',
    description: 'ãƒ›ãƒ«ãƒ¢ãƒ³ãƒãƒ©ãƒ³ã‚¹ãƒã‚§ãƒƒã‚¯ã¨æ›´å¹´æœŸå¯¾ç­–',
    price: 25000,
    category: 'health_checkup',
    partnerId: 'partner-8',
    status: 'active',
    createdAt: new Date().toISOString()
  }
]

// è¨ˆç®—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
const isFormValid = computed(() => {
  return answers.age && answers.budget && answers.healthConcerns.length > 0
})

const availableCategories = computed(() => [
  { value: 'health_checkup', label: 'å¥åº·è¨ºæ–­' },
  { value: 'dental_care', label: 'æ­¯ç§‘ã‚±ã‚¢' },
  { value: 'beauty_treatment', label: 'ç¾å®¹ã‚±ã‚¢' },
  { value: 'fitness', label: 'ãƒ•ã‚£ãƒƒãƒˆãƒã‚¹' },
  { value: 'nutrition', label: 'æ „é¤Šç›¸è«‡' },
  { value: 'mental_health', label: 'ãƒ¡ãƒ³ã‚¿ãƒ«ãƒ˜ãƒ«ã‚¹' }
])

const filteredGifts = computed(() => {
  let gifts = availableGifts.filter(gift => {
    // äºˆç®—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
    const budgetMatch = filterByBudget(gift.price, answers.budget)
    if (!budgetMatch) return false

    // å¥åº·ã¸ã®é–¢å¿ƒäº‹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
    const healthConcernMatch = filterByHealthConcern(gift.category, answers.healthConcerns)
    if (!healthConcernMatch) return false

    // ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
    if (selectedCategories.value.length > 0 && !selectedCategories.value.includes(gift.category)) {
      return false
    }

    return true
  })

  // å¹´é½¢ã¨æ€§åˆ¥ã«åŸºã¥ãå„ªå…ˆåº¦èª¿æ•´
  gifts = sortGiftsByRelevance(gifts, answers.age, answers.gender)

  return gifts
})

// ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
const findGifts = async () => {
  if (!isFormValid.value) return

  loading.value = true
  
  // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®é…å»¶
  await new Promise(resolve => setTimeout(resolve, 1000))
  
  loading.value = false
  showRecommendations.value = true
  
  // åˆæœŸã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’è¨­å®š
  selectedCategories.value = answers.healthConcerns.map(concern => {
    const mapping: Record<string, string> = {
      'general-health': 'health_checkup',
      'dental-care': 'dental_care',
      'beauty-care': 'beauty_treatment',
      'fitness': 'fitness',
      'nutrition': 'nutrition',
      'mental-health': 'mental_health'
    }
    return mapping[concern] || concern
  })
}

// ãƒ•ã‚©ãƒ¼ãƒ ã«æˆ»ã‚‹
const backToForm = () => {
  showRecommendations.value = false
  selectedGift.value = null
  selectedCategories.value = []
}

// ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®åˆ‡ã‚Šæ›¿ãˆ
const toggleCategoryFilter = (category: string) => {
  const index = selectedCategories.value.indexOf(category)
  if (index > -1) {
    selectedCategories.value.splice(index, 1)
  } else {
    selectedCategories.value.push(category)
  }
}

// ã‚®ãƒ•ãƒˆé¸æŠ
const selectGift = (gift: Gift) => {
  selectedGift.value = gift
}

// æ³¨æ–‡ã«é€²ã‚€
const proceedToOrder = () => {
  if (selectedGift.value) {
    router.push(`/order/${selectedGift.value.id}`)
  }
}

// ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°é–¢æ•°
const filterByBudget = (giftPrice: number, budgetRange: string): boolean => {
  switch (budgetRange) {
    case '5000-10000':
      return giftPrice >= 5000 && giftPrice <= 10000
    case '10000-20000':
      return giftPrice >= 10000 && giftPrice <= 20000
    case '20000-30000':
      return giftPrice >= 20000 && giftPrice <= 30000
    case '30000-50000':
      return giftPrice >= 30000 && giftPrice <= 50000
    case '50000+':
      return giftPrice >= 50000
    default:
      return true
  }
}

const filterByHealthConcern = (giftCategory: string, healthConcerns: string[]): boolean => {
  const categoryMapping: Record<string, string[]> = {
    'general-health': ['health_checkup'],
    'dental-care': ['dental_care'],
    'beauty-care': ['beauty_treatment'],
    'fitness': ['fitness'],
    'nutrition': ['nutrition'],
    'mental-health': ['mental_health']
  }

  return healthConcerns.some(concern => {
    const categories = categoryMapping[concern] || []
    return categories.includes(giftCategory)
  })
}

const sortGiftsByRelevance = (gifts: Gift[], age: string, gender: string): Gift[] => {
  return gifts.sort((a, b) => {
    let scoreA = 0
    let scoreB = 0

    // å¹´é½¢ã«åŸºã¥ãã‚¹ã‚³ã‚¢
    if (age === '20-29' || age === '30-39') {
      if (a.category === 'fitness' || a.category === 'beauty_treatment') scoreA += 2
      if (b.category === 'fitness' || b.category === 'beauty_treatment') scoreB += 2
    } else if (age === '40-49' || age === '50-59') {
      if (a.category === 'health_checkup' || a.category === 'nutrition') scoreA += 2
      if (b.category === 'health_checkup' || b.category === 'nutrition') scoreB += 2
    } else if (age === '60-69' || age === '70+') {
      if (a.category === 'health_checkup' || a.category === 'dental_care') scoreA += 2
      if (b.category === 'health_checkup' || b.category === 'dental_care') scoreB += 2
    }

    // æ€§åˆ¥ã«åŸºã¥ãã‚¹ã‚³ã‚¢
    if (gender === 'female') {
      if (a.category === 'beauty_treatment' || a.category === 'mental_health') scoreA += 1
      if (b.category === 'beauty_treatment' || b.category === 'mental_health') scoreB += 1
    } else if (gender === 'male') {
      if (a.category === 'fitness' || a.category === 'health_checkup') scoreA += 1
      if (b.category === 'fitness' || b.category === 'health_checkup') scoreB += 1
    }

    return scoreB - scoreA
  })
}

// ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
const getGiftIcon = (category: string): string => {
  const icons: Record<string, string> = {
    'health_checkup': 'ğŸ¥',
    'dental_care': 'ğŸ¦·',
    'beauty_treatment': 'âœ¨',
    'fitness': 'ğŸ’ª',
    'nutrition': 'ğŸ¥—',
    'mental_health': 'ğŸ§ '
  }
  return icons[category] || 'ğŸ'
}

const getCategoryLabel = (category: string): string => {
  const labels: Record<string, string> = {
    'health_checkup': 'å¥åº·è¨ºæ–­',
    'dental_care': 'æ­¯ç§‘ã‚±ã‚¢',
    'beauty_treatment': 'ç¾å®¹ã‚±ã‚¢',
    'fitness': 'ãƒ•ã‚£ãƒƒãƒˆãƒã‚¹',
    'nutrition': 'æ „é¤Šç›¸è«‡',
    'mental_health': 'ãƒ¡ãƒ³ã‚¿ãƒ«ãƒ˜ãƒ«ã‚¹'
  }
  return labels[category] || category
}

onMounted(() => {
  console.log('Gift Consultation component mounted')
})
</script>

<style scoped>
.gift-consultation {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

.consultation-header {
  text-align: center;
  margin-bottom: 3rem;
}

.consultation-header h2 {
  font-size: 2.5rem;
  color: #2c3e50;
  margin-bottom: 1rem;
}

.consultation-header p {
  font-size: 1.2rem;
  color: #7f8c8d;
}

/* ãƒ•ã‚©ãƒ¼ãƒ  */
.consultation-form {
  background: white;
  border-radius: 20px;
  padding: 2rem;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  margin-bottom: 2rem;
}

.form-section {
  margin-bottom: 2rem;
}

.form-section h3 {
  color: #667eea;
  margin-bottom: 1rem;
  font-size: 1.3rem;
}

.form-group {
  margin-bottom: 1.5rem;
}

.form-group label {
  display: block;
  margin-bottom: 0.5rem;
  color: #2c3e50;
  font-weight: 600;
}

.form-control {
  width: 100%;
  padding: 0.75rem;
  border: 2px solid #ecf0f1;
  border-radius: 10px;
  font-size: 1rem;
  transition: border-color 0.3s ease;
}

.form-control:focus {
  outline: none;
  border-color: #667eea;
}

.checkbox-group {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
}

.checkbox-item {
  display: flex;
  align-items: center;
  cursor: pointer;
  padding: 0.5rem;
  border-radius: 8px;
  transition: background-color 0.3s ease;
}

.checkbox-item:hover {
  background-color: #f8f9fa;
}

.checkbox-item input[type="checkbox"] {
  margin-right: 0.5rem;
}

.form-actions {
  text-align: center;
  margin-top: 2rem;
}

.submit-button {
  background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
  border: none;
  color: white;
  font-size: 1.2rem;
  padding: 1rem 3rem;
  border-radius: 50px;
  box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
  transition: all 0.3s ease;
}

.submit-button:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
}

.submit-button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* æ¨è–¦çµæœ */
.recommendations {
  background: white;
  border-radius: 20px;
  padding: 2rem;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
}

.recommendations-header {
  text-align: center;
  margin-bottom: 2rem;
}

.recommendations-header h3 {
  color: #27ae60;
  font-size: 2rem;
  margin-bottom: 1rem;
}

.recommendations-header p {
  color: #7f8c8d;
  margin-bottom: 1rem;
}

/* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ */
.filter-options {
  margin-bottom: 2rem;
  padding: 1rem;
  background: #f8f9fa;
  border-radius: 15px;
}

.filter-group label {
  display: block;
  margin-bottom: 0.5rem;
  color: #2c3e50;
  font-weight: 600;
}

.filter-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.filter-btn {
  padding: 0.5rem 1rem;
  border: 2px solid #ecf0f1;
  border-radius: 20px;
  background: white;
  color: #2c3e50;
  cursor: pointer;
  transition: all 0.3s ease;
}

.filter-btn:hover {
  border-color: #667eea;
}

.filter-btn.active {
  background: #667eea;
  color: white;
  border-color: #667eea;
}

/* ã‚®ãƒ•ãƒˆä¸€è¦§ */
.gifts-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 1.5rem;
}

.gift-card {
  background: white;
  border: 2px solid #ecf0f1;
  border-radius: 15px;
  padding: 1.5rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.gift-card:hover {
  border-color: #667eea;
  transform: translateY(-2px);
  box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
}

.gift-image {
  text-align: center;
  margin-bottom: 1rem;
}

.gift-icon {
  font-size: 3rem;
}

.gift-info h4 {
  color: #2c3e50;
  margin-bottom: 0.5rem;
  font-size: 1.2rem;
}

.gift-description {
  color: #7f8c8d;
  margin-bottom: 1rem;
  line-height: 1.5;
}

.gift-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.gift-price {
  color: #e74c3c;
  font-weight: 600;
  font-size: 1.1rem;
}

.gift-category {
  background: #667eea;
  color: white;
  padding: 0.3rem 0.8rem;
  border-radius: 20px;
  font-size: 0.8rem;
}

/* ã‚®ãƒ•ãƒˆãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ */
.no-gifts {
  text-align: center;
  padding: 3rem;
  color: #7f8c8d;
}

/* é¸æŠã•ã‚ŒãŸã‚®ãƒ•ãƒˆã®ãƒ¢ãƒ¼ãƒ€ãƒ« */
.selected-gift-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.modal-content {
  background: white;
  border-radius: 20px;
  padding: 2rem;
  max-width: 500px;
  width: 90%;
  max-height: 80vh;
  overflow-y: auto;
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
}

.modal-header h3 {
  color: #2c3e50;
  margin: 0;
}

.close-btn {
  background: none;
  border: none;
  font-size: 1.5rem;
  color: #7f8c8d;
  cursor: pointer;
}

.gift-detail {
  text-align: center;
}

.gift-image-large {
  margin-bottom: 1rem;
}

.gift-icon-large {
  font-size: 4rem;
}

.gift-detail h4 {
  color: #2c3e50;
  margin-bottom: 1rem;
  font-size: 1.3rem;
}

.gift-detail p {
  color: #7f8c8d;
  margin-bottom: 1rem;
  line-height: 1.6;
}

.gift-price-large {
  color: #e74c3c;
  font-weight: 600;
  font-size: 1.5rem;
  margin-bottom: 2rem;
}

.gift-actions {
  display: flex;
  gap: 1rem;
  justify-content: center;
}

.order-btn {
  background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
  border: none;
  color: white;
}

/* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ */
@media (max-width: 768px) {
  .gift-consultation {
    padding: 1rem;
  }
  
  .consultation-header h2 {
    font-size: 2rem;
  }
  
  .gifts-grid {
    grid-template-columns: 1fr;
  }
  
  .filter-buttons {
    flex-direction: column;
  }
  
  .gift-actions {
    flex-direction: column;
  }
}
</style> 